# GITLAB_API_ACCESS

check_var_gitlab_api:
  stage: featureCheck
  variables:
    GIT_SSL_NO_VERIFY: "true"
  tags: 
   - kubernetes
   - linux
  image:
    name: ubuntu:bionic
  rules:
   - if: '$DEPLOYMENT_INIT'
     when: always
   - if: '$CI_PIPELINE_SOURCE == "web"'
     when: never
   - if: $CI_PIPELINE_SOURCE == "push"
     when: never
   - if: $CI_MULTI_TRIGGER
     when: never
   - changes:
       - _ci-maintain/variable-check.json
  script:
    - 'curl --insecure --header "PRIVATE-TOKEN: $GITLAB_API_ACCESS" $CI_SERVER_URL/api/v4/groups'
    - 'echo "Gitlab API key was added to the project or instance level! You can add new tools under tool-index.json, and they will be imported on your commit"'
